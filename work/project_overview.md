# نظرة عامة على مشروع نظام إدارة عيادة تقويم الأسنان

## 1. الهدف الأساسي للمشروع

يهدف هذا المشروع إلى إنشاء نظام إدارة متكامل (Clinic Management System) لعيادة تقويم أسنان، يركز على تحسين الكفاءة التشغيلية، تبسيط سير العمل، وتعزيز تجربة كل من الموظفين (الأطباء، الممرضين، الإداريين) والمرضى.

---

## 2. الأقسام الرئيسية ومسؤولياتها

يتكون النظام من عدة أقسام رئيسية، كل منها يؤدي وظائف محددة ويتفاعل مع الأقسام الأخرى.

### أ. لوحة التحكم الرئيسية (Dashboard)

- **المهمة**: توفير نظرة شاملة وفورية على الحالة الحالية للعيادة.
- **الوظائف**:
  - عرض حالة جميع الغرف (مشغولة، متاحة).
  - عرض قائمة انتظار المرضى الحالية وتصنيفهم (في الانتظار، داخل الغرفة، مكتمل).
  - توفير إجراءات سريعة مثل استدعاء المريض التالي.
- **المستخدمون**: الممرضون، مساعدو الأطباء، مديرو العيادة.

### ب. إدارة المرضى (Patient Management)

- **المهمة**: إدارة جميع سجلات المرضى بشكل مركزي.
- **الوظائف**:
  - عرض قائمة بجميع المرضى المسجلين مع معلومات أساسية.
  - إضافة مريض جديد وتعديل بيانات مريض حالي.
  - عرض ملف المريض التفصيلي (معلومات شخصية، تاريخ علاجي، حالة مالية).
- **المستخدمون**: الممرضون، الإداريون.

### ج. شاشة الانتظار (Waiting Room Display)

- **المهمة**: توفير واجهة عرض ديناميكية وموجهة للمرضى في منطقة الانتظار.
- **الوظائف**:
  - عرض اسم ورقم المريض الذي تم استدعاؤه بشكل بارز وفوري.
  - تشغيل نداء صوتي متزامن مع العرض البصري.
  - عرض قائمة بالمرضى المنتظرين وحالتهم (ينتظر، لم يحضر، في الغرفة) بألوان مميزة.
- **المستخدمون**: المرضى في منطقة الانتظار.

### د. صفحات الغرف المخصصة (Dedicated Room Pages)

- **المهمة**: توفير واجهة تحكم خاصة لكل طبيب داخل غرفته.
- **الوظائف**:
  - عرض حالة الغرفة الحالية.
  - زر لاستدعاء المريض التالي مباشرة من داخل الغرفة.
  - عرض سجل بالمرضى الذين زاروا هذه الغرفة.
- **المستخدمون**: الأطباء، مساعدو الأطباء.

### هـ. الأقسام المستقبلية (قيد الإنشاء)

- **المالية (Financials)**: لإدارة جميع المعاملات المالية، الفواتير، والديون.
- **التقارير (Reports)**: لتوليد تقارير إحصائية حول أداء العيادة.
- **الإعدادات (Settings)**: لتخصيص إعدادات النظام.

---

## 3. آلية التواصل بين الأقسام

يعتمد النظام على عدة آليات لضمان تدفق البيانات والتزامن بين أقسامه المختلفة:

### أ. إدارة الحالة المركزية (Central State Management)

- **الأداة**: React Context API (`AppProvider`).
- **الوصف**: يتم تخزين الحالة الرئيسية للتطبيق (قوائم المرضى، المواعيد) في مكان واحد مركزي. أي تغيير في هذه الحالة (مثل تحديث حالة مريض) ينعكس تلقائيًا على جميع المكونات التي تستخدم هذه البيانات.

### ب. المزامنة عبر علامات التبويب (Cross-tab Synchronization)

- **المشكلة**: لوحة التحكم تعمل في علامة تبويب، وشاشة الانتظار في علامة تبويب أخرى.
- **الحل**: يتم استخدام `localStorage` في المتصفح كوسيط لمشاركة البيانات الحيوية.
  1.  عندما يقوم موظف باستدعاء مريض من **لوحة التحكم**، يتم تحديث بيانات المريض المستدعى في `localStorage`.
  2.  **شاشة الانتظار** تقوم بمراقبة التغييرات في `localStorage` (أو إعادة تحميل نفسها بشكل دوري)، وعندما تكتشف وجود بيانات جديدة، تقوم بتحديث واجهتها فورًا.

### ج. التنقل وتمرير البيانات (Routing & Data Passing)

- **الأداة**: Next.js App Router.
- **الوصف**: يتم استخدام المسارات الديناميكية للوصول إلى صفحات معينة وتمرير معرفات فريدة.
  - **مثال 1**: النقر على بطاقة مريض في صفحة `patients` ينقل المستخدم إلى `/patients/[patientId]`، حيث يتم استخدام `patientId` لجلب وعرض بيانات المريض الصحيح.
  - **مثال 2**: النقر على بطاقة غرفة في لوحة التحكم ينقل المستخدم إلى `/rooms/[roomId]` لفتح صفحة التحكم الخاصة بتلك الغرفة.

### د. تدفق الذكاء الاصطناعي (AI Flow)

- **الأداة**: Genkit (مع Google AI).
- **الوصف**: يتم استخدام تدفقات Genkit لتنفيذ مهام الذكاء الاصطناعي.
  - **مثال**: عند استدعاء مريض، يتم تفعيل تدفق `announceNextPatient` الذي يقوم بتحويل النص (اسم المريض ورقمه) إلى كلام منطوق (صوت) يتم تشغيله على شاشة الانتظار.
